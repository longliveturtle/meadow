<!DOCTYPE html>
<html lang="en-US">

<!-- Mirrored from stats.oarc.ucla.edu/r/dae/negative-binomial-regression/ by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 01 Mar 2025 04:12:19 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head >
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Negative Binomial Regression |  R Data Analysis Examples</title>
<meta name='robots' content='max-image-preview:large' />
	<style>img:is([sizes="auto" i], [sizes^="auto," i]) { contain-intrinsic-size: 3000px 1500px }</style>
	
<script>
MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};

</script>
<link rel='dns-prefetch' href='../../../../cdn.jsdelivr.net/index.html' />
<link rel='dns-prefetch' href='../../../../platform-api.sharethis.com/index.html' />
<link rel="alternate" type="application/rss+xml" title="OARC Stats &raquo; Feed" href="../../../feed/index.html" />
<link rel="alternate" type="application/rss+xml" title="OARC Stats &raquo; Comments Feed" href="../../../comments/feed/index.html" />
<link rel="alternate" type="text/calendar" title="OARC Stats &raquo; iCal Feed" href="../../../calendar/indexedf3.html?ical=1" />
<link rel="canonical" href="index.html" />
<script type="text/javascript">
/* <![CDATA[ */
window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/15.0.3\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/15.0.3\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/stats.oarc.ucla.edu\/wp-includes\/js\/wp-emoji-release.min.js?ver=6.7.1"}};
/*! This file is auto-generated */
!function(i,n){var o,s,e;function c(e){try{var t={supportTests:e,timestamp:(new Date).valueOf()};sessionStorage.setItem(o,JSON.stringify(t))}catch(e){}}function p(e,t,n){e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(t,0,0);var t=new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data),r=(e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(n,0,0),new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data));return t.every(function(e,t){return e===r[t]})}function u(e,t,n){switch(t){case"flag":return n(e,"\ud83c\udff3\ufe0f\u200d\u26a7\ufe0f","\ud83c\udff3\ufe0f\u200b\u26a7\ufe0f")?!1:!n(e,"\ud83c\uddfa\ud83c\uddf3","\ud83c\uddfa\u200b\ud83c\uddf3")&&!n(e,"\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc65\udb40\udc6e\udb40\udc67\udb40\udc7f","\ud83c\udff4\u200b\udb40\udc67\u200b\udb40\udc62\u200b\udb40\udc65\u200b\udb40\udc6e\u200b\udb40\udc67\u200b\udb40\udc7f");case"emoji":return!n(e,"\ud83d\udc26\u200d\u2b1b","\ud83d\udc26\u200b\u2b1b")}return!1}function f(e,t,n){var r="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?new OffscreenCanvas(300,150):i.createElement("canvas"),a=r.getContext("2d",{willReadFrequently:!0}),o=(a.textBaseline="top",a.font="600 32px Arial",{});return e.forEach(function(e){o[e]=t(a,e,n)}),o}function t(e){var t=i.createElement("script");t.src=e,t.defer=!0,i.head.appendChild(t)}"undefined"!=typeof Promise&&(o="wpEmojiSettingsSupports",s=["flag","emoji"],n.supports={everything:!0,everythingExceptFlag:!0},e=new Promise(function(e){i.addEventListener("DOMContentLoaded",e,{once:!0})}),new Promise(function(t){var n=function(){try{var e=JSON.parse(sessionStorage.getItem(o));if("object"==typeof e&&"number"==typeof e.timestamp&&(new Date).valueOf()<e.timestamp+604800&&"object"==typeof e.supportTests)return e.supportTests}catch(e){}return null}();if(!n){if("undefined"!=typeof Worker&&"undefined"!=typeof OffscreenCanvas&&"undefined"!=typeof URL&&URL.createObjectURL&&"undefined"!=typeof Blob)try{var e="postMessage("+f.toString()+"("+[JSON.stringify(s),u.toString(),p.toString()].join(",")+"));",r=new Blob([e],{type:"text/javascript"}),a=new Worker(URL.createObjectURL(r),{name:"wpTestEmojiSupports"});return void(a.onmessage=function(e){c(n=e.data),a.terminate(),t(n)})}catch(e){}c(n=f(s,u,p))}t(n)}).then(function(e){for(var t in e)n.supports[t]=e[t],n.supports.everything=n.supports.everything&&n.supports[t],"flag"!==t&&(n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&n.supports[t]);n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&!n.supports.flag,n.DOMReady=!1,n.readyCallback=function(){n.DOMReady=!0}}).then(function(){return e}).then(function(){var e;n.supports.everything||(n.readyCallback(),(e=n.source||{}).concatemoji?t(e.concatemoji):e.wpemoji&&e.twemoji&&(t(e.twemoji),t(e.wpemoji)))}))}((window,document),window._wpemojiSettings);
/* ]]> */
</script>
<link rel="stylesheet" href="../../../wp-content/cache/minify/9df84.css" media="all" />

<style id='wp-emoji-styles-inline-css' type='text/css'>

	img.wp-smiley, img.emoji {
		display: inline !important;
		border: none !important;
		box-shadow: none !important;
		height: 1em !important;
		width: 1em !important;
		margin: 0 0.07em !important;
		vertical-align: -0.1em !important;
		background: none !important;
		padding: 0 !important;
	}
</style>
<link rel="stylesheet" href="../../../wp-content/cache/minify/a5ff7.css" media="all" />

<style id='classic-theme-styles-inline-css' type='text/css'>
/*! This file is auto-generated */
.wp-block-button__link{color:#fff;background-color:#32373c;border-radius:9999px;box-shadow:none;text-decoration:none;padding:calc(.667em + 2px) calc(1.333em + 2px);font-size:1.125em}.wp-block-file__button{background:#32373c;color:#fff;text-decoration:none}
</style>
<style id='global-styles-inline-css' type='text/css'>
:root{--wp--preset--aspect-ratio--square: 1;--wp--preset--aspect-ratio--4-3: 4/3;--wp--preset--aspect-ratio--3-4: 3/4;--wp--preset--aspect-ratio--3-2: 3/2;--wp--preset--aspect-ratio--2-3: 2/3;--wp--preset--aspect-ratio--16-9: 16/9;--wp--preset--aspect-ratio--9-16: 9/16;--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;--wp--preset--shadow--natural: 6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep: 12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp: 6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined: 6px 6px 0px -3px rgba(255, 255, 255, 1), 6px 6px rgba(0, 0, 0, 1);--wp--preset--shadow--crisp: 6px 6px 0px rgba(0, 0, 0, 1);}:where(.is-layout-flex){gap: 0.5em;}:where(.is-layout-grid){gap: 0.5em;}body .is-layout-flex{display: flex;}.is-layout-flex{flex-wrap: wrap;align-items: center;}.is-layout-flex > :is(*, div){margin: 0;}body .is-layout-grid{display: grid;}.is-layout-grid > :is(*, div){margin: 0;}:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}
:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}
:root :where(.wp-block-pullquote){font-size: 1.5em;line-height: 1.6;}
</style>
<link rel="stylesheet" href="../../../wp-content/cache/minify/4c431.css" media="all" />

<style id='contact-form-7-inline-css' type='text/css'>
.wpcf7 .wpcf7-recaptcha iframe {margin-bottom: 0;}.wpcf7 .wpcf7-recaptcha[data-align="center"] > div {margin: 0 auto;}.wpcf7 .wpcf7-recaptcha[data-align="right"] > div {margin: 0 0 0 auto;}
</style>
<link rel="stylesheet" href="../../../wp-content/cache/minify/4033d.css" media="all" />



<link rel='stylesheet' id='slicknavcss-css' href='../../../../cdn.jsdelivr.net/jquery.slicknav/0.1/slicknav.css?ver=1' type='text/css' media='all' />
<script  src="../../../wp-content/cache/minify/818c0.js"></script>


<script type="text/javascript" src="../../../../cdn.jsdelivr.net/jquery.slicknav/0.1/jquery.slicknav.min.js?ver=1" id="slicknav-js"></script>
<script type="text/javascript" src="../../../../platform-api.sharethis.com/js/sharethis.js#source=googleanalytics-wordpress#product=ga&amp;property=5b058eb03e4a630011ba71c0" id="googleanalytics-platform-sharethis-js"></script>
<link rel="https://api.w.org/" href="../../../wp-json/index.html" /><link rel="alternate" title="JSON" type="application/json" href="../../../wp-json/wp/v2/pages/926.json" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="../../../xmlrpc0db0.html?rsd" />
<link rel="alternate" title="oEmbed (JSON)" type="application/json+oembed" href="../../../wp-json/oembed/1.0/embed4bf3.json?url=https%3A%2F%2Fstats.oarc.ucla.edu%2Fr%2Fdae%2Fnegative-binomial-regression%2F" />
<link rel="alternate" title="oEmbed (XML)" type="text/xml+oembed" href="../../../wp-json/oembed/1.0/embed0ef8?url=https%3A%2F%2Fstats.oarc.ucla.edu%2Fr%2Fdae%2Fnegative-binomial-regression%2F&amp;format=xml" />
<meta name="tec-api-version" content="v1"><meta name="tec-api-origin" content="https://stats.oarc.ucla.edu"><link rel="alternate" href="../../../wp-json/tribe/events/v1/index.html" /><link rel="icon" href="../../../wp-content/themes/genesis-child/images/favicon.ico" />
<link rel="pingback" href="../../../xmlrpc.html" />
<script>
(function() {
	(function (i, s, o, g, r, a, m) {
		i['GoogleAnalyticsObject'] = r;
		i[r] = i[r] || function () {
				(i[r].q = i[r].q || []).push(arguments)
			}, i[r].l = 1 * new Date();
		a = s.createElement(o),
			m = s.getElementsByTagName(o)[0];
		a.async = 1;
		a.src = g;
		m.parentNode.insertBefore(a, m)
	})(window, document, 'script', '../../../../google-analytics.com/analytics.js', 'ga');

	ga('create', 'UA-121222866-1', 'auto');
			ga('send', 'pageview');
	})();
</script>

<link rel="icon" href="../../../wp-includes/images/w-logo-blue-white-bg.png" type="image/x-icon" />
<link rel="shortcut icon" href="../../../wp-includes/images/w-logo-blue-white-bg.png" type="image/x-icon" />

</head>

<body class="page-template-default page page-id-926 page-child parent-pageid-916 tribe-no-js header-image content-sidebar genesis-breadcrumbs-hidden genesis-footer-widgets-hidden" itemscope itemtype="https://schema.org/WebPage"><div class="site-container"><ul class="genesis-skip-link"><li><a href="#genesis-nav-primary" class="screen-reader-shortcut"> Skip to primary navigation</a></li><li><a href="#genesis-content" class="screen-reader-shortcut"> Skip to main content</a></li><li><a href="#genesis-sidebar-primary" class="screen-reader-shortcut"> Skip to primary sidebar</a></li></ul><header class="site-header" itemscope itemtype="https://schema.org/WPHeader"><div class="wrap"><div class="title-area">	<div class="title-area">

	<div class="site-title" itemprop="headline"><a href="https://stats.oarc.ucla.edu/">stats.oarc.ucla.edu</a></div>

	<p class="site-description" itemprop="description">Statistical Methods and Data Analytics</p></div>
</div><div class="widget-area header-widget-area"><section id="custom_html-7" class="widget_text widget widget_custom_html"><div class="widget_text widget-wrap"><div class="textwidget custom-html-widget"><div><div class = "top-wrap"><div id = "ucla-logo"><img alt="Image " src = "../../../wp-content/uploads/logo/idrelogo4.png" width = 380px alt = "IDRE Logo"></div></div>
</div></div></div></section>
<section id="search-11" class="widget widget_search"><div class="widget-wrap"><form class="search-form" method="get" action="https://stats.oarc.ucla.edu/" role="search" itemprop="potentialAction" itemscope itemtype="https://schema.org/SearchAction"><label class="search-form-label screen-reader-text" for="searchform-1">Search this website</label><input class="search-form-input" type="search" name="s" id="searchform-1" placeholder="Search this website" itemprop="query-input"><input class="search-form-submit" type="submit" value="Search"><meta content="https://stats.oarc.ucla.edu/?s={s}" itemprop="target"></form></div></section>
</div></div></header><nav class="nav-primary" aria-label="Main" itemscope itemtype="https://schema.org/SiteNavigationElement" id="genesis-nav-primary"><div class="wrap"><ul id="menu-idre-stats-navigation-menu" class="menu genesis-nav-menu menu-primary js-superfish"><li id="menu-item-22640" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-22640"><a href="https://stats.oarc.ucla.edu/" itemprop="url"><span itemprop="name">HOME</span></a></li>
<li id="menu-item-22662" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-22662"><a href="#" itemprop="url"><span itemprop="name">SOFTWARE</span></a>
<ul class="sub-menu">
	<li id="menu-item-22646" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-22646"><a href="../../index.html" itemprop="url"><span itemprop="name">R</span></a></li>
	<li id="menu-item-22649" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-22649"><a href="https://stats.oarc.ucla.edu/stata/" itemprop="url"><span itemprop="name">Stata</span></a></li>
	<li id="menu-item-22647" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-22647"><a href="https://stats.oarc.ucla.edu/sas/" itemprop="url"><span itemprop="name">SAS</span></a></li>
	<li id="menu-item-22648" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-22648"><a href="https://stats.oarc.ucla.edu/spss/" itemprop="url"><span itemprop="name">SPSS</span></a></li>
	<li id="menu-item-22659" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-22659"><a href="https://stats.oarc.ucla.edu/mplus/" itemprop="url"><span itemprop="name">Mplus</span></a></li>
	<li id="menu-item-22657" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-22657"><a href="https://stats.oarc.ucla.edu/other/" itemprop="url"><span itemprop="name">Other Packages</span></a>
	<ul class="sub-menu">
		<li id="menu-item-22658" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-22658"><a href="https://stats.oarc.ucla.edu/other/gpower/" itemprop="url"><span itemprop="name">G*Power</span></a></li>
		<li id="menu-item-22684" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-22684"><a href="https://stats.oarc.ucla.edu/other/sudaan/" itemprop="url"><span itemprop="name">SUDAAN</span></a></li>
		<li id="menu-item-22696" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-22696"><a href="https://stats.oarc.ucla.edu/spss/spss-user/sample-power/" itemprop="url"><span itemprop="name">Sample Power</span></a></li>
	</ul>
</li>
</ul>
</li>
<li id="menu-item-22661" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-22661"><a href="https://stats.oarc.ucla.edu/" itemprop="url"><span itemprop="name">RESOURCES</span></a>
<ul class="sub-menu">
	<li id="menu-item-22656" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-22656"><a href="https://stats.oarc.ucla.edu/annotatedoutput" itemprop="url"><span itemprop="name">Annotated Output</span></a></li>
	<li id="menu-item-22651" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-22651"><a href="../../../other/dae/index.html" itemprop="url"><span itemprop="name">Data Analysis Examples</span></a></li>
	<li id="menu-item-22654" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-22654"><a href="https://stats.oarc.ucla.edu/other/mult-pkg/faq/" itemprop="url"><span itemprop="name">Frequently Asked Questions</span></a></li>
	<li id="menu-item-22652" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-22652"><a href="https://stats.oarc.ucla.edu/other/mult-pkg/seminars/" itemprop="url"><span itemprop="name">Seminars</span></a></li>
	<li id="menu-item-22653" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-22653"><a href="https://stats.oarc.ucla.edu/other/examples/" itemprop="url"><span itemprop="name">Textbook Examples</span></a></li>
	<li id="menu-item-22692" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-22692"><a href="https://stats.oarc.ucla.edu/other/mult-pkg/whatstat/" itemprop="url"><span itemprop="name">Which Statistical Test?</span></a></li>
</ul>
</li>
<li id="menu-item-22663" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-22663"><a href="https://stats.oarc.ucla.edu/" itemprop="url"><span itemprop="name">SERVICES</span></a>
<ul class="sub-menu">
	<li id="menu-item-33775" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33775"><a href="https://stats.idre.ucla.edu/ucla/policies/remote" itemprop="url"><span itemprop="name">Remote Consulting</span></a></li>
	<li id="menu-item-22655" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-22655"><a href="https://stats.oarc.ucla.edu/ucla/policies" itemprop="url"><span itemprop="name">Services and Policies</span></a>
	<ul class="sub-menu">
		<li id="menu-item-22885" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-22885"><a href="https://stats.oarc.ucla.edu/ucla/policies/#WalkIn" itemprop="url"><span itemprop="name">Walk-In Consulting</span></a></li>
		<li id="menu-item-22882" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-22882"><a href="https://stats.oarc.ucla.edu/ucla/policies/#EmailConsult" itemprop="url"><span itemprop="name">Email Consulting</span></a></li>
		<li id="menu-item-22880" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-22880"><a href="https://stats.oarc.ucla.edu/ucla/policies/#Fee" itemprop="url"><span itemprop="name">Fee for Service</span></a></li>
		<li id="menu-item-30604" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-30604"><a href="https://stats.idre.ucla.edu/ucla/frequently-asked-questions-about-our-statistical-consulting-services/" itemprop="url"><span itemprop="name">FAQ</span></a></li>
	</ul>
</li>
	<li id="menu-item-22687" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-22687"><a href="https://stats.oarc.ucla.edu/purchasing-and-updatingstatistical-software-packages/" itemprop="url"><span itemprop="name">Software Purchasing and Updating</span></a></li>
	<li id="menu-item-22688" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-22688"><a href="https://stats.oarc.ucla.edu/statistical-consultants-for-hire/" itemprop="url"><span itemprop="name">Consultants for Hire</span></a></li>
	<li id="menu-item-23684" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-23684"><a itemprop="url"><span itemprop="name">Other Consulting Centers</span></a>
	<ul class="sub-menu">
		<li id="menu-item-23685" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-23685"><a href="http://scc.stat.ucla.edu/" itemprop="url"><span itemprop="name">Department of Statistics Consulting Center</span></a></li>
		<li id="menu-item-23686" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-23686"><a href="https://www.cores.ucla.edu/statistical-biomathematical-consulting-clinic-sbcc/" itemprop="url"><span itemprop="name">Department of Biomathematics Consulting Clinic</span></a></li>
	</ul>
</li>
</ul>
</li>
<li id="menu-item-22664" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-22664"><a href="https://stats.oarc.ucla.edu/ucla/about" itemprop="url"><span itemprop="name">ABOUT US</span></a></li>
</ul></div></nav><div class="site-inner"><div class="content-sidebar-wrap"><main class="content" id="genesis-content"><article class="post-926 page type-page status-publish entry" aria-label="Negative Binomial Regression |  R Data Analysis Examples" itemscope itemtype="https://schema.org/CreativeWork"><header class="entry-header"><h1 class="entry-title" itemprop="headline">Negative Binomial Regression |  R Data Analysis Examples</h1>
</header><div class="entry-content" itemprop="text"><p>Negative binomial regression is for modeling count variables, usually for
over-dispersed count outcome variables.</p>
<p>This page uses the following packages. Make sure that you can load
them before trying to run the examples on this page. If you do not have
a package installed, run: <code>install.packages("packagename")</code>, or
if you see the version is out of date, run: <code>update.packages()</code>.</p>
<div id="unnamed-chunk-2" class="chunk">
<div class="rcode">
<div class="source">
<pre class="knitr r"><span class="functioncall">require</span>(foreign)
<span class="functioncall">require</span>(ggplot2)
<span class="functioncall">require</span>(MASS)
</pre>
</div>
</div>
</div>
<p><code class="knitr inline"><strong>Version info: </strong>Code for this page was tested in R Under development (unstable) (2013-01-06 r61571)
On: 2013-01-22
With: MASS 7.3-22; ggplot2 0.9.3; foreign 0.8-52; knitr 1.0.5
</code></p>
<p><strong>Please note:</strong> The purpose of this
page is to show how to use various data analysis commands. It does not cover
all aspects of the research process which researchers are expected to do. In
particular, it does not cover data cleaning and checking, verification of
assumptions, model diagnostics or potential follow-up analyses.</p>
<h2>Examples of negative binomial regression</h2>
<p>Example 1. School administrators study the attendance behavior of high
school juniors at two schools. Predictors of the number of days of absence
include the type of program in which the student is enrolled and a standardized
test in math.</p>
<p>Example 2. A health-related researcher is studying the number of hospital
visits in past 12 months by senior citizens in a community based on the
characteristics of the individuals and the types of health plans under which
each one is covered.</p>
<h2>Description of the data</h2>
<p>Let&#8217;s pursue Example 1 from above.</p>
<p>We have attendance data on 314 high school juniors from two urban high schools in
the file <code>nb_data</code>. The response variable of interest is days absent, <code>daysabs</code>.
The variable <code>math</code> gives the standardized math score for
each student. The variable <code>prog</code> is a three-level nominal variable indicating the
type of instructional program in which the student is enrolled.</p>
<p>Let&#8217;s look at the data. It is always a good idea to start with descriptive statistics and plots.</p>
<div id="unnamed-chunk-3" class="chunk">
<div class="rcode">
<div class="source">
<pre class="knitr r">dat &lt;- <span class="functioncall">read.dta</span>(<span class="string">"https://stats.idre.ucla.edu/stat/stata/dae/nb_data.dta"</span>)
dat &lt;- <span class="functioncall">within</span>(dat, {
    prog &lt;- <span class="functioncall">factor</span>(prog, levels = 1:3, labels = <span class="functioncall">c</span>(<span class="string">"General"</span>, <span class="string">"Academic"</span>, <span class="string">"Vocational"</span>))
    id &lt;- <span class="functioncall">factor</span>(id)
})

<span class="functioncall">summary</span>(dat)
</pre>
</div>
<div class="output">
<pre class="knitr r">##        id         gender         math         daysabs     
##  1001   :  1   female:160   Min.   : 1.0   Min.   : 0.00  
##  1002   :  1   male  :154   1st Qu.:28.0   1st Qu.: 1.00  
##  1003   :  1                Median :48.0   Median : 4.00  
##  1004   :  1                Mean   :48.3   Mean   : 5.96  
##  1005   :  1                3rd Qu.:70.0   3rd Qu.: 8.00  
##  1006   :  1                Max.   :99.0   Max.   :35.00  
##  (Other):308                                              
##          prog    
##  General   : 40  
##  Academic  :167  
##  Vocational:107  
##                  
##                  
##                  
## 
</pre>
</div>
<div class="source">
<pre class="knitr r"><span class="functioncall">ggplot</span>(dat, <span class="functioncall">aes</span>(daysabs, fill = prog)) + <span class="functioncall">geom_histogram</span>(binwidth = 1) + <span class="functioncall">facet_grid</span>(prog ~ 
    ., margins = <span class="keyword">TRUE</span>, scales = <span class="string">"free"</span>)
</pre>
</div>
</div>
<div class="rimage default"><img decoding="async" class="plot" src="../../../wp-content/uploads/2016/02/nbreg-unnamed-chunk-3.png" alt="Histogram plots showing distribution of the data" width="500px" height="500px" /></div>
</div>
<p>Each variable has 314 valid observations and their distributions seem quite reasonable.
The unconditional mean of our outcome variable is much lower than its variance.</p>
<p>Let&#8217;s continue with our description of the variables in this dataset.
The table below shows the average numbers of days absent by program type
and seems to suggest that program type is a good candidate for predicting the number of
days absent, our outcome variable, because the mean value of the outcome appears to vary by
<code>prog</code>. The variances within each level of <code>prog</code> are
higher than the means within each level. These are the conditional means and
variances. These differences suggest that over-dispersion is present and that a
Negative Binomial model would be appropriate.</p>
<div id="unnamed-chunk-4" class="chunk">
<div class="rcode">
<div class="source">
<pre class="knitr r"><span class="functioncall">with</span>(dat, <span class="functioncall">tapply</span>(daysabs, prog, <span class="functioncall"><span class="keyword">function</span></span>(x) {
    <span class="functioncall">sprintf</span>(<span class="string">"<span class="functioncall">M</span> (SD) = %<span class="functioncall">1.2f</span> (%1.2f)"</span>, <span class="functioncall">mean</span>(x), <span class="functioncall">sd</span>(x))
}))
</pre>
</div>
<div class="output">
<pre class="knitr r">##                 General                Academic              Vocational 
## "M (SD) = 10.65 (8.20)"  "M (SD) = 6.93 (7.45)"  "M (SD) = 2.67 (3.73)"
</pre>
</div>
</div>
</div>
<h2>Analysis methods you might consider</h2>
<p>Below is a list of some analysis methods you may have
encountered. Some of the methods listed are quite reasonable, while others have
either fallen out of favor or have limitations.</p>
<ul>
<li>Negative binomial regression -Negative binomial regression can be used
for over-dispersed count data, that is when the conditional variance exceeds
the conditional mean. It can be considered as a generalization of Poisson
regression since it has the same mean structure as Poisson regression and it
has an extra parameter to model the over-dispersion. If the conditional
distribution of the outcome variable is over-dispersed, the confidence
intervals for the Negative binomial regression are likely to be wider as
compared to those from a Poisson regression model.</li>
<li>Poisson regression &#8211; Poisson regression is often used for modeling count
data. Poisson regression has a number of extensions useful for count models.</li>
<li>Zero-inflated regression model &#8211; Zero-inflated models attempt to account
for excess zeros. In other words, two kinds of zeros are thought to exist
in the data, &#8220;true zeros&#8221; and &#8220;excess zeros&#8221;. Zero-inflated models estimate
two equations simultaneously, one for the count model and one for the excess
zeros.</li>
<li>OLS regression &#8211; Count outcome variables are sometimes log-transformed
and analyzed using OLS regression. Many issues arise with this approach,
including loss of data due to undefined values generated by taking the log
of zero (which is undefined), as well as the lack of capacity to model the
dispersion.</li>
</ul>
<h2>Negative binomial regression analysis</h2>
<p>Below we use the <code>glm.nb</code> function from the <code>MASS</code> package to
estimate a negative binomial regression.</p>
<div id="unnamed-chunk-5" class="chunk">
<div class="rcode">
<div class="source">
<pre class="knitr r"><span class="functioncall">summary</span>(m1 &lt;- <span class="functioncall">glm.nb</span>(daysabs ~ math + prog, data = dat))
</pre>
</div>
<div class="output">
<pre class="knitr r">## 
## Call:
## glm.nb(formula = daysabs ~ math + prog, data = dat, init.theta = 1.032713156, 
##     link = log)
## 
## Deviance Residuals: 
##    Min      1Q  Median      3Q     Max  
## -2.155  -1.019  -0.369   0.229   2.527  
## 
## Coefficients:
##                Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)     2.61527    0.19746   13.24  &lt; 2e-16 ***
## math           -0.00599    0.00251   -2.39    0.017 *  
## progAcademic   -0.44076    0.18261   -2.41    0.016 *  
## progVocational -1.27865    0.20072   -6.37  1.9e-10 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## (Dispersion parameter for Negative Binomial(1.033) family taken to be 1)
## 
##     Null deviance: 427.54  on 313  degrees of freedom
## Residual deviance: 358.52  on 310  degrees of freedom
## AIC: 1741
## 
## Number of Fisher Scoring iterations: 1
## 
## 
##               Theta:  1.033 
##           Std. Err.:  0.106 
## 
##  2 x log-likelihood:  -1731.258
</pre>
</div>
</div>
</div>
<ul>
<li style="list-style-type: none;">
<ul>
<li>R first displays the call and the deviance residuals. Next, we see the
regression coefficients for each of the variables, along with standard
errors, z-scores, and p-values. The variable <code>math</code> has a coefficient
of -0.006, which is statistically significant. This means that for each
one-unit increase in <code>math</code>, the expected log count of the number of
days absent decreases by 0.006. The indicator variable shown as <code>progAcademic</code>
is the expected difference in log count between group 2 and the reference
group (<code>prog</code>=1). The expected log count for level 2 of <code>prog</code> is
0.44 lower than the expected log count for level 1. The indicator variable
for <code>progVocational</code> is the expected difference in log count between
group 3 and the reference group.The expected log count for level 3 of <code>
prog</code> is 1.28 lower than the expected log count for level 1. To
determine if <code>prog</code> itself, overall, is statistically significant, we
can compare a model with and without <code>prog</code>. The reason it is important
to fit separate models, is that unless we do, the overdispersion parameter is
held constant.</li>
</ul>
</li>
</ul>
<div id="unnamed-chunk-6" class="chunk">
<div class="rcode">
<div class="source">
<pre class="knitr r">m2 &lt;- <span class="functioncall">update</span>(m1, . ~ . - prog)
<span class="functioncall">anova</span>(m1, m2)
</pre>
</div>
<div class="output">
<pre class="knitr r">## Likelihood ratio tests of Negative Binomial Models
## 
## Response: daysabs
##         Model  theta Resid. df    2 x log-lik.   Test    df LR stat.
## 1        math 0.8559       312           -1776                      
## 2 math + prog 1.0327       310           -1731 1 vs 2     2    45.05
##     Pr(Chi)
## 1          
## 2 1.652e-10
</pre>
</div>
</div>
</div>
<ul>
<li>The two degree-of-freedom chi-square test indicates that <code>prog</code> is
a statistically significant predictor of <code>daysabs</code>.</li>
<li>The null deviance is calculated from an intercept-only model with 313
degrees of freedom. Then we see the residual deviance, the deviance from the
full model. We are also shown the AIC and 2*log likelihood.</li>
<li>The theta parameter shown is the dispersion parameter. Note that R
parameterizes this differently from SAS, Stata, and SPSS. The R parameter
(theta) is equal to the inverse of the dispersion parameter (alpha)
estimated in these other software packages. Thus, the theta value of 1.033
seen here is equivalent to the 0.968 value seen in the
<a href="https://stats.oarc.ucla.edu/stata/dae/negative-binomial-regression/">Stata Negative Binomial
Data Analysis Example</a> because 1/0.968 = 1.033.</li>
</ul>
<h2>Checking model assumption</h2>
<p>As we mentioned earlier, negative binomial models assume the conditional means
are not equal to the conditional variances. This inequality is captured by
estimating a dispersion parameter (not shown in the output) that is held
constant in a Poisson model. Thus, the Poisson
model is actually nested in the negative binomial model. We can then use a
likelihood ratio test to compare these two and test this model assumption. To do this, we will run our model as
a Poisson.</p>
<div id="unnamed-chunk-7" class="chunk">
<div class="rcode">
<div class="source">
<pre class="knitr r">m3 &lt;- <span class="functioncall">glm</span>(daysabs ~ math + prog, family = <span class="string">"poisson"</span>, data = dat)
<span class="functioncall">pchisq</span>(2 * (<span class="functioncall">logLik</span>(m1) - <span class="functioncall">logLik</span>(m3)), df = 1, lower.tail = <span class="keyword">FALSE</span>)
</pre>
</div>
<div class="output">
<pre class="knitr r">## 'log Lik.' 2.157e-203 (df=5)
</pre>
</div>
</div>
</div>
<p>In this example the associated chi-squared value estimated from 2*(logLik(m1) &#8211; logLik(m3)) is 926.03 with one degree
of freedom. This strongly suggests the negative binomial model,
estimating the dispersion parameter, is more
appropriate than the Poisson model.</p>
<p>We can get the confidence intervals for the coefficients by
profiling the likelihood function.</p>
<div id="unnamed-chunk-8" class="chunk">
<div class="rcode">
<div class="source">
<pre class="knitr r">(est &lt;- <span class="functioncall">cbind</span>(Estimate = <span class="functioncall">coef</span>(m1), <span class="functioncall">confint</span>(m1)))
</pre>
</div>
<div class="message">
<pre class="knitr r">## Waiting for profiling to be done...
</pre>
</div>
<div class="output">
<pre class="knitr r">##                 Estimate   2.5 %    97.5 %
## (Intercept)     2.615265  2.2421  3.012936
## math           -0.005993 -0.0109 -0.001067
## progAcademic   -0.440760 -0.8101 -0.092643
## progVocational -1.278651 -1.6835 -0.890078
</pre>
</div>
</div>
</div>
<p>We might be interested in looking at incident rate ratios rather than
coefficients. To do this, we can exponentiate our model coefficients. The same
applies to the confidence intervals.</p>
<div id="unnamed-chunk-9" class="chunk">
<div class="rcode">
<div class="source">
<pre class="knitr r"><span class="functioncall">exp</span>(est)
</pre>
</div>
<div class="output">
<pre class="knitr r">##                Estimate  2.5 %  97.5 %
## (Intercept)     13.6708 9.4127 20.3470
## math             0.9940 0.9892  0.9989
## progAcademic     0.6435 0.4448  0.9115
## progVocational   0.2784 0.1857  0.4106
</pre>
</div>
</div>
</div>
<p>The output above indicates that the incident rate for <code>prog</code> = 2
is 0.64 times the incident rate for the reference group (<code>prog</code> = 1).
Likewise, the incident rate for <code>prog</code> = 3 is 0.28 times the incident
rate for the reference group holding the other variables constant. The
percent change in the incident rate of <code>daysabs</code> is a 1% decrease
for every unit increase in <code>math</code>.</p>
<p>The form of the model equation for negative binomial regression is
the same as that for Poisson regression. The log of the expected outcome is
predicted with a linear combination of the predictors:</p>
<p>\[
ln(\widehat{daysabs_i}) = Intercept + b_1I(prog_i = 2) + b_2I(prog_i = 3) + b_3math_i
\]</p>
<p>where $I(prog_i = j)$ is an indicator function such that if  $prog_i = j$ is equal to 1 and otherwise is equal to 0, for $j \in \{2, 3\}$. Therefore,</p>
<p>\[
\widehat{daysabs_i} = e^{Intercept + b_1 I(prog_i = 2) + b_2I(prog_i = 3) + b_3 math_i} =
e^{Intercept}e^{b_1 I(prog_i = 2)}e^{b_2 I(prog_i = 3)}e^{b_3  math_i}
\]</p>
<p>The coefficients have an <em>additive</em> effect in the $ln(y)$ scale
and the IRR have a <em>multiplicative</em> effect in the $y$ scale. The
dispersion parameter in negative binomial regression
does not affect the expected counts, but it does affect the estimated variance of
the expected counts. More details can be found in the <i>Modern Applied
Statistics with S</i> by W.N. Venables and B.D. Ripley (the book
companion of the <code>MASS</code> package).</p>
<p>For additional information on the various metrics in which the
results can be presented, and the interpretation of such, please see <i>
Regression Models for Categorical Dependent Variables Using Stata,
Second Edition</i> by J. Scott Long and Jeremy Freese (2006).</p>
<h2>Predicted values</h2>
<p>For assistance in further understanding the model, we can look at predicted
counts for various levels of our predictors. Below we create new datasets with
values of <code>math</code> and <code>prog</code> and then use the <code>predict</code> command to
calculate the predicted number of events.</p>
<p>First, we can look at predicted counts for each value of <code>prog</code> while
holding <code>math</code> at its mean.
To do this, we create a new dataset with the combinations of <code>prog</code> and
<code>math</code> for which we would like to find predicted values, then use the <code>predict</code>
command.</p>
<div id="unnamed-chunk-10" class="chunk">
<div class="rcode">
<div class="source">
<pre class="knitr r">newdata1 &lt;- <span class="functioncall">data.frame</span>(math = <span class="functioncall">mean</span>(dat$math), prog = <span class="functioncall">factor</span>(1:3, levels = 1:3, 
    labels = <span class="functioncall">levels</span>(dat$prog)))
newdata1$phat &lt;- <span class="functioncall">predict</span>(m1, newdata1, type = <span class="string">"response"</span>)
newdata1
</pre>
</div>
<div class="output">
<pre class="knitr r">##    math       prog   phat
## 1 48.27    General 10.237
## 2 48.27   Academic  6.588
## 3 48.27 Vocational  2.850
</pre>
</div>
</div>
</div>
<p>In the output above, we see that the predicted number of events (e.g., days
absent) for a general program is about 10.24, holding <code>math</code> at its mean. The predicted
number of events for an academic program is lower at 6.59, and the
predicted number of events for a vocational program is about 2.85.</p>
<p>Below we will obtain the mean predicted number of events for values of <code>math</code>
across its entire range for each level of <code>prog</code> and graph these.</p>
<div id="unnamed-chunk-11" class="chunk">
<div class="rcode">
<div class="source">
<pre class="knitr r">newdata2 &lt;- <span class="functioncall">data.frame</span>(
  math = <span class="functioncall">rep</span>(<span class="functioncall">seq</span>(from = <span class="functioncall">min</span>(dat$math), to = <span class="functioncall">max</span>(dat$math), length.out = 100), 3),
  prog = <span class="functioncall">factor</span>(<span class="functioncall">rep</span>(1:3, each = 100), levels = 1:3, labels =
  <span class="functioncall">levels</span>(dat$prog)))

newdata2 &lt;- <span class="functioncall">cbind</span>(newdata2, <span class="functioncall">predict</span>(m1, newdata2, type = <span class="string">"link"</span>, se.fit=<span class="keyword">TRUE</span>))
newdata2 &lt;- <span class="functioncall">within</span>(newdata2, {
  DaysAbsent &lt;- <span class="functioncall">exp</span>(fit)
  LL &lt;- <span class="functioncall">exp</span>(fit - 1.96 * se.fit)
  UL &lt;- <span class="functioncall">exp</span>(fit + 1.96 * se.fit)
})

<span class="functioncall">ggplot</span>(newdata2, <span class="functioncall">aes</span>(math, DaysAbsent)) +
  <span class="functioncall">geom_ribbon</span>(<span class="functioncall">aes</span>(ymin = LL, ymax = UL, fill = prog), alpha = .25) +
  <span class="functioncall">geom_line</span>(<span class="functioncall">aes</span>(colour = prog), size = 2) +
  <span class="functioncall">labs</span>(x = <span class="string">"Math Score"</span>, y = <span class="string">"Predicted Days Absent"</span>)
</pre>
</div>
</div>
<div class="rimage default"><img decoding="async" class="plot" src="../../../wp-content/uploads/2016/02/nbreg-unnamed-chunk-11.png" alt="Plot of the model predicted days absent with confidence intervals" width="500px" height="500px" /></div>
</div>
<p>The graph shows the expected count across the range of math scores,
for each type of program along with 95 percent confidence intervals.
Note that the lines are not straight because this is a log linear model, and
what is plotted are the expected values, not the log of the expected values.</p>
<h2>Things to consider</h2>
<ul>
<li>It is not recommended that negative binomial models be applied to small
samples.</li>
<li>One common cause of over-dispersion is excess zeros by an additional
data generating process. In this situation, zero-inflated model should be
considered.</li>
<li>If the data generating process does not allow for any 0s (such as the
number of days spent in the hospital), then a zero-truncated model may be
more appropriate.</li>
<li>Count data often have an exposure variable, which indicates the number
of times the event could have happened. This variable should be
incorporated into your negative binomial regression model with the use of
the <code>offset</code> option. See the <code>glm</code> documentation for details.</li>
<li>The outcome variable in a negative binomial regression cannot have negative numbers.</li>
<li>You will need to use the <code>m1$resid</code> command to obtain the residuals
from our model to check other assumptions
of the negative binomial model (see Cameron and Trivedi (1998) and Dupont (2002) for
more information).</li>
</ul>
<h2>References</h2>
<ul>
<li>Long, J. S. 1997. <i>Regression Models for Categorical and Limited Dependent Variables.</i>
Thousand Oaks, CA: Sage Publications.</li>
<li>Long, J. S. and Freese, J. 2006. <i>Regression Models for
Categorical Dependent Variables Using Stata, Second Edition</i>.
College Station, TX: Stata Press.</li>
<li>Cameron, A. C. and Trivedi, P. K. 2009. <i>Microeconometrics Using
Stata</i>. College Station, TX: Stata Press.</li>
<li>Cameron, A. C. and Trivedi, P. K. 1998. <i>Regression
Analysis of Count Data</i>. New York: Cambridge Press.</li>
<li>Cameron, A. C. Advances in Count Data Regression Talk for the
Applied Statistics Workshop, March 28, 2009.
<a href="http://cameron.econ.ucdavis.edu/racd/count.html">
http://cameron.econ.ucdavis.edu/racd/count.html</a> .</li>
<li>Dupont, W. D. 2002. <i>Statistical Modeling for Biomedical
Researchers: A Simple Introduction to the Analysis of Complex Data.</i>
New York: Cambridge Press.</li>
<li>Venables, W.N. and Ripley, B.D. 2002. <i>Modern Applied Statistics with
S, Fourth Edition</i>. New York: Springer.</li>
</ul>
<h2>See also</h2>
<ul>
<li>R online documentation:
<a href="http://stat.ethz.ch/R-manual/R-patched/library/stats/html/glm.html">glm</a></li>
</ul>
<p>&nbsp;</p>
<p>&nbsp;</p>
</div></article></main><aside class="sidebar sidebar-primary widget-area" role="complementary" aria-label="Primary Sidebar" itemscope itemtype="https://schema.org/WPSideBar" id="genesis-sidebar-primary"><h2 class="genesis-sidebar-title screen-reader-text">Primary Sidebar</h2></aside><hr><div style="clear:both;">
          <p style="float:left;"><span class="collapseomatic " id="id67c27738500f3"  tabindex="0" title="Click here to report an error on this page or leave a comment"    >Click here to report an error on this page or leave a comment</span><span id='swap-id67c27738500f3'  class='colomat-swap' style='display:none;'> </span><div id="target-id67c27738500f3" class="collapseomatic_content ">
<div class="wpcf7 no-js" id="wpcf7-f22910-o1" lang="en-US" dir="ltr">
<div class="screen-reader-response"><p role="status" aria-live="polite" aria-atomic="true"></p> <ul></ul></div>
<form action="https://stats.oarc.ucla.edu/r/dae/negative-binomial-regression/#wpcf7-f22910-o1" method="post" class="wpcf7-form init" aria-label="Contact form" novalidate="novalidate" data-status="init">
<div style="display: none;">
<input type="hidden" name="_wpcf7" value="22910" />
<input type="hidden" name="_wpcf7_version" value="5.9.6" />
<input type="hidden" name="_wpcf7_locale" value="en_US" />
<input type="hidden" name="_wpcf7_unit_tag" value="wpcf7-f22910-o1" />
<input type="hidden" name="_wpcf7_container_post" value="0" />
<input type="hidden" name="_wpcf7_posted_data_hash" value="" />
<input type="hidden" name="_wpcf7_recaptcha_response" value="" />
</div>
<p><label for="namefield"> Your Name (required)<br />
<span class="wpcf7-form-control-wrap" data-name="your-name"><input size="40" maxlength="80" class="wpcf7-form-control wpcf7-text wpcf7-validates-as-required" id="namefield" aria-required="true" aria-invalid="false" value="" type="text" name="your-name" /></span><br />
</label>
</p>
<p><label for="emailfield"> Your Email (must be a valid email for us to receive the report!)<br />
<span class="wpcf7-form-control-wrap" data-name="your-email"><input size="40" maxlength="80" class="wpcf7-form-control wpcf7-email wpcf7-validates-as-required wpcf7-text wpcf7-validates-as-email" id="emailfield" aria-required="true" aria-invalid="false" value="" type="email" name="your-email" /></span><br />
</label>
</p>
<p><label for="commentfield"> Comment/Error Report (required)<br />
<span class="wpcf7-form-control-wrap" data-name="your-message"><textarea cols="40" rows="10" maxlength="400" class="wpcf7-form-control wpcf7-textarea wpcf7-validates-as-required" id="commentfield" aria-required="true" aria-invalid="false" name="your-message"></textarea></span><br />
</label>
</p>
<span class="wpcf7-form-control-wrap recaptcha"><span data-sitekey="6LfYdSEUAAAAALpzE4-TLY8d8B8SKVQBCnKVDCNH" class="wpcf7-form-control wpcf7-recaptcha g-recaptcha"></span>
<noscript>
	<div class="grecaptcha-noscript">
		<iframe src="https://www.google.com/recaptcha/api/fallback?k=6LfYdSEUAAAAALpzE4-TLY8d8B8SKVQBCnKVDCNH" frameborder="0" scrolling="no" width="310" height="430">
		</iframe>
		<textarea name="g-recaptcha-response" rows="3" cols="40" placeholder="reCaptcha Response Here">
		</textarea>
	</div>
</noscript>
</span>
<p><input class="wpcf7-form-control wpcf7-submit has-spinner" type="submit" value="Send" />
</p><p style="display: none !important;" class="akismet-fields-container" data-prefix="_wpcf7_ak_"><label>&#916;<textarea name="_wpcf7_ak_hp_textarea" cols="45" rows="8" maxlength="100"></textarea></label><input type="hidden" id="ak_js_1" name="_wpcf7_ak_js" value="237"/><script>document.getElementById( "ak_js_1" ).setAttribute( "value", ( new Date() ).getTime() );</script></p><div class="wpcf7-response-output" aria-hidden="true"></div>
</form>
</div>
</div></p><p style="float:right;">
          <a href="https://stats.idre.ucla.edu/other/mult-pkg/faq/general/faq-how-do-i-cite-web-pages-and-programs-from-the-ucla-statistical-consulting-group/">How to cite this page</a>
          </p></div></div></div>

    <div class="wrapped">
        <a href="https://oarc.ucla.edu/" title="UCLA Office of Advanced Research Technology" id="footer-image">UCLA OARC</a>
    </div>

    <div class="ftr-btm">
        <div class="footer-links">
        <ol>
            <li><a href="http://www.ucla.edu/terms-of-use/">© 2024 UC REGENTS</a></li>
            <li><a href="https://stats.oarc.ucla.edu/">HOME</a></li>
            <li><a href="https://stats.oarc.ucla.edu/contact">CONTACT</a></li>
        </ol>
        </div>
    </div>
<script>
			jQuery(function($) {
			$('.genesis-nav-menu').slicknav();
			});
			</script>		<script>
		( function ( body ) {
			'use strict';
			body.className = body.className.replace( /\btribe-no-js\b/, 'tribe-js' );
		} )( document.body );
		</script>
		<script> /* <![CDATA[ */var tribe_l10n_datatables = {"aria":{"sort_ascending":": activate to sort column ascending","sort_descending":": activate to sort column descending"},"length_menu":"Show _MENU_ entries","empty_table":"No data available in table","info":"Showing _START_ to _END_ of _TOTAL_ entries","info_empty":"Showing 0 to 0 of 0 entries","info_filtered":"(filtered from _MAX_ total entries)","zero_records":"No matching records found","search":"Search:","all_selected_text":"All items on this page were selected. ","select_all_link":"Select all pages","clear_selection":"Clear Selection.","pagination":{"all":"All","next":"Next","previous":"Previous"},"select":{"rows":{"0":"","_":": Selected %d rows","1":": Selected 1 row"}},"datepicker":{"dayNames":["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],"dayNamesShort":["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],"dayNamesMin":["S","M","T","W","T","F","S"],"monthNames":["January","February","March","April","May","June","July","August","September","October","November","December"],"monthNamesShort":["January","February","March","April","May","June","July","August","September","October","November","December"],"monthNamesMin":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"nextText":"Next","prevText":"Prev","currentText":"Today","closeText":"Done","today":"Today","clear":"Clear"}};/* ]]> */ </script><script  src="../../../wp-content/cache/minify/1f540.js"></script>

<script type="text/javascript" id="contact-form-7-js-extra">
/* <![CDATA[ */
var wpcf7 = {"api":{"root":"https:\/\/stats.oarc.ucla.edu\/wp-json\/","namespace":"contact-form-7\/v1"},"cached":"1"};
/* ]]> */
</script>
<script  src="../../../wp-content/cache/minify/b68ea.js"></script>

<script type="text/javascript" src="../../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml.js?ver=6.7.1" id="mathjax-js"></script>



<script  src="../../../wp-content/cache/minify/f3065.js"></script>

<script type="text/javascript" id="collapseomatic-js-js-before">
/* <![CDATA[ */
const com_options = {"colomatduration":"fast","colomatslideEffect":"slideFade","colomatpauseInit":"","colomattouchstart":""}
/* ]]> */
</script>

<script  src="../../../wp-content/cache/minify/d7287.js"></script>

<script type="text/javascript" id="google-recaptcha-js-extra">
/* <![CDATA[ */
var wpcf7iqfix = {"recaptcha_empty":"Please verify that you are not a robot.","response_err":"wpcf7-recaptcha: Could not verify reCaptcha response."};
/* ]]> */
</script>
<script type="text/javascript" src="../../../../www.google.com/recaptcha/apidba9.js?hl=en_US&amp;onload=recaptchaCallback&amp;render=explicit&amp;ver=2.0" id="google-recaptcha-js"></script>
<script  defer src="../../../wp-content/cache/minify/45ffb.js"></script>





<!--
Performance optimized by W3 Total Cache. Learn more: https://www.boldgrid.com/w3-total-cache/

Page Caching using Disk: Enhanced 
Minified using Disk

Served from: stats.oarc.ucla.edu @ 2025-02-28 18:55:52 by W3 Total Cache
-->