{"id":932,"date":"2016-02-11T18:29:03","date_gmt":"2016-02-11T18:29:03","guid":{"rendered":"http:\/\/dev2.hpc.ucla.edu\/r\/dae-3\/r-data-analysis-examplespower-analysis-for-two-group-independent-sample-t-test\/"},"modified":"2021-08-25T13:38:49","modified_gmt":"2021-08-25T20:38:49","slug":"power-analysis-for-two-group-independent-sample-t-test","status":"publish","type":"page","link":"https:\/\/stats.oarc.ucla.edu\/r\/dae\/power-analysis-for-two-group-independent-sample-t-test\/","title":{"rendered":"Power Analysis for Two-group Independent sample t-test |  R Data Analysis Examples"},"content":{"rendered":"<h2>Examples <\/h2>\n<p>Example 1. A clinical dietician wants to compare two different diets, A \nand B, for diabetic patients. She hypothesizes that diet A (Group 1) will be better than \ndiet B (Group 2), in terms of lower blood glucose. She plans to get a random sample of \ndiabetic patients and randomly assign them to one of the two diets. At the end \nof the experiment, which lasts 6 weeks, a fasting blood glucose test will be \nconducted on each patient. She also expects that the average difference in \nblood glucose measure between the two group will be about 10 mg\/dl. Furthermore, \nshe also assumes the standard deviation of blood glucose distribution for diet \nA to be 15 and the standard deviation for diet B to be 17. The dietician wants to know \nthe number of subjects needed in each group assuming equal sized groups. <\/p>\n<p>Example 2. An audiologist wanted to study the effect of gender on the \nresponse time to a certain sound frequency. He suspected that men were better at \ndetecting this type of sound then were women. \nHe took a random sample of 20 male and 20 female subjects \nfor this experiment. Each subject was be given a button to press \nwhen he\/she heard the sound. The audiologist then measured the response time &#8211; the time \nbetween the sound was emitted and the time the button was pressed. \nNow, he \nwants to know what the statistical power is based on his total of 40 \nsubjects to detect the gender difference.<\/p>\n<h2>Prelude to The Power Analysis<\/h2>\n<p>There are two different aspects of power analysis. One is to calculate the necessary\nsample size for a specified power as in Example 1. The other aspect  is to calculate the power when\ngiven a specific sample size as in Example 2. Technically, power is the probability of rejecting \nthe null hypothesis when the specific alternative hypothesis is true.&nbsp;<\/p>\n<p>For the power analyses below, we are going to focus on Example 1, calculating \nthe sample size for a given statistical power of testing the difference in the \neffect of diet A and diet B. Notice the assumptions that the dietician has made in order \nto perform the power analysis. Here is the information we have to know or have \nto assume in order to perform the power analysis: <\/p>\n<ul>\n<li>The expected difference in the average blood glucose; in this case it is \n\tset to 10.<\/li>\n<li>The standard deviations of blood glucose for Group 1 and Group 2; in this \n\tcase, they are set to 15 and 17 respectively.&nbsp; <\/li>\n<li>The alpha level, or the Type I error rate, which is the \n\tprobability of rejecting the null hypothesis when it is actually true.&nbsp; \n\tA \n\tcommon practice is to set it at the .05 level. <\/li>\n<li>The pre-specified level of statistical power for calculating the sample \n\tsize; this will be set to .8.<\/li>\n<li>The pre-specified number of subjects for calculating the statistical \n\tpower; this is the situation for Example 2.<\/li>\n<\/ul>\n<p>Notice that in the first example, the dietician didn&#8217;t specify the mean for each \ngroup, instead she only specified the difference of the two means. This is \nbecause that she is only interested in the difference, and it does not matter \nwhat the means are as long as the difference is the same. <\/p>\n<h2>Power Analysis<\/h2>\n<p>In R, it is fairly straightforward to perform power analysis for \ncomparing means. For example, we can use the <b>pwr<\/b> package in R for our \ncalculation as shown below. We first specify the two means, the mean for Group 1 \n(diet A) and the mean for Group 2 (diet B). Since what really matters is the \ndifference, instead of means for each group, we can enter a mean of zero for Group 1  \nand 10 for the mean of Group 2, so that the difference in means will be 10. Next, we \nneed to specify the \npooled standard deviation, which is the square root of the average of the two \nstandard deviations <em>squared<\/em>. In this case, it is sqrt((15^2 + 17^2)\/2) = 16.03. The default significance level (alpha level) is  .05. \nFor this example we will set the power to be at .8.<\/p>\n<blockquote>\n<pre><b>library(pwr)\r\n\t\r\npwr.t.test(d=(0-10)\/16.03,power=.8,sig.level=.05,type=\"two.sample\",alternative=\"two.sided\")<\/b>\r\n\r\n     Two-sample t test power calculation \r\n\r\n              n = 41.31968\r\n              d = 0.6238303\r\n      sig.level = 0.05\r\n          power = 0.8\r\n    alternative = two.sided\r\n\r\n NOTE: n is number in *each* group <\/pre>\n<\/blockquote>\n<p>The calculation results indicate  that we need 42 subjects for diet A and \nanother 42 subject for diet B in our sample in order the effect. Now, let&#8217;s use \nanother pair of means with the same difference. As we have discussed earlier, \nthe results should be the same, and they are.<\/p>\n<blockquote>\n<pre><b>pwr.t.test(d=(5-15)\/16.03,power=.8,sig.level=.05,type=\"two.sample\",alternative=\"two.sided\")<\/b>\r\n\r\n     Two-sample t test power calculation \r\n\r\n              n = 41.31968\r\n              d = 0.6238303\r\n      sig.level = 0.05\r\n          power = 0.8\r\n    alternative = two.sided\r\n\r\n NOTE: n is number in *each* group <\/pre>\n<\/blockquote>\n<p>Now the dietician may feel that a total sample size of 84 subjects is beyond her \nbudget. One way of reducing the sample size is to increase the Type I error \nrate, or the alpha level. Let&#8217;s say instead of using alpha level of .05 we will \nuse .07. Then our sample size will reduce by 4 for each group as shown below.<\/p>\n<blockquote>\n<pre><b>pwr.t.test(d=(5-15)\/16.03,power=.8,sig.level=.07,type=\"two.sample\",alternative=\"two.sided\")<\/b>\r\n\r\n     Two-sample t test power calculation \r\n\r\n              n = 37.02896\r\n              d = 0.6238303\r\n      sig.level = 0.07\r\n          power = 0.8\r\n    alternative = two.sided\r\n\r\n NOTE: n is number in *each* group <\/pre>\n<\/blockquote>\n<p>Now suppose the dietician can only collect data on 60 subjects with 30 in each \ngroup. What will the statistical power for her t-test be with respect to alpha \nlevel of .05?<\/p>\n<blockquote>\n<pre><b>pwr.t.test(d=(5-15)\/16.03,n=30,sig.level=.05,type=\"two.sample\",alternative=\"two.sided\")<\/b>\r\n\r\n     Two-sample t test power calculation \r\n\r\n              n = 30\r\n              d = 0.6238303\r\n      sig.level = 0.05\r\n          power = 0.6612888\r\n    alternative = two.sided\r\n\r\n NOTE: n is number in *each* group <\/pre>\n<\/blockquote>\n<p><!-- \n\n<p>What if she actually collected her data on 60 subjects but with 40 on diet A \nand 20 on diet B instead of equal sample sizes in the groups? <\/p>\n\n\n\n\n<blockquote>\n\t\n\n<pre><b> proc power; \r\n   twosamplemeans test=diff \r\n   groupmeans = 0 | 10 \r\n   stddev = 16.03\r\n   groupns = (40 20)\r\n   power = .; \r\n run;<\/b><\/pre>\n\n\n\t\n\n<pre>Two-sample t Test for Mean Difference<\/pre>\n\n\n\t\n\n<pre>      Fixed Scenario Elements<\/pre>\n\n\n\t\n\n<pre>Distribution                 Normal\r\nMethod                        Exact\r\nGroup 1 Mean                      0\r\nGroup 2 Mean                     10\r\nStandard Deviation            16.03\r\nGroup 1 Sample Size              40\r\nGroup 2 Sample Size              20\r\nNumber of Sides                   2\r\nNull Difference                   0\r\nAlpha                          0.05\r\n<\/pre>\n\n\n\t\n\n<pre>Computed Power<\/pre>\n\n\n\t\n\n<pre>Power<\/pre>\n\n\n\t\n\n<pre>0.610<\/pre>\n\n\n<\/blockquote>\n\n\n         \n\n\n<p>As you can see the power goes down from .661 to .610 even though the total number of subjects \nis the same. This is why we always say that a balanced design is more efficient.<\/p>\n\n --><\/p>\n<p>As we have discussed before, what really matters in the calculation of power \nor sample size is the difference of the means over the pooled standard \ndeviation. This is a measure of effect size. Let&#8217;s now look at how the effect \nsize affects the sample size assuming a given sample power. We can simply assume \nthe difference in means and set the standard deviation to be 1 and create\na table with effect size, d, varying from .2 to 1.2.&nbsp; <\/p>\n<blockquote>\n<pre><b>ptab<-cbind(NULL, NULL)       # initalize ptab\r\n\r\n for (i in c(.2, .3, .4, .5, .6, .7, .8, .9, 1, 1.1, 1.2)){\r\n   pwrt<-pwr.t.test(d=i,power=.8,sig.level=.05,type=\"two.sample\",alternative=\"two.sided\")\r\n   ptab<-rbind(ptab, cbind(pwrt$d, pwrt$n))\r\n }\r\n\r\nptab<\/b>\r\n\r\n      [,1]      [,2]\r\n [1,]  0.2 393.40570\r\n [2,]  0.3 175.38467\r\n [3,]  0.4  99.08032\r\n [4,]  0.5  63.76561\r\n [5,]  0.6  44.58579\r\n [6,]  0.7  33.02458\r\n [7,]  0.8  25.52457\r\n [8,]  0.9  20.38633\r\n [9,]  1.0  16.71473\r\n[10,]  1.1  14.00190\r\n[11,]  1.2  11.94226<\/pre>\n<\/blockquote>\n<p>We can also easily display this information in a plot. <\/p>\n<blockquote>\n<pre><b>plot(ptab[,1],ptab[,2],type=\"b\",xlab=\"effect size\",ylab=\"sample size\")<\/b><\/pre>\n<p><img decoding=\"async\" border=\"0\" src=\"https:\/\/stats.idre.ucla.edu\/wp-content\/uploads\/2016\/02\/power.png\"\">\n<\/p><\/blockquote>\n<p>It shows that if the effect size is small, such .2 then we need a very large \nsample size and that sample size drops as effect size increases. We can also easily\nplot power versus sample size for a given effects size, say, d = 0.7<\/p>\n<blockquote>\n<pre><b>pwrt<-pwr.t.test(d=.7,n=c(10,20,30,40,50,60,70,80,90,100),sig.level=.05,type=\"two.sample\",alternative=\"two.sided\")\r\n\r\nplot(pwrt$n,pwrt$power,type=\"b\",xlab=\"sample size\",ylab=\"power\")<\/b>\r\n\r\n<img decoding=\"async\" src=\"https:\/\/stats.idre.ucla.edu\/wp-content\/uploads\/2016\/02\/power2.png\"><\/pre>\n<\/blockquote>\n<h2>Discussion<\/h2>\n<p>An important technical assumption is the normality assumption. If the \ndistribution is skewed, then a small sample size may not have the power shown in \nthe results, because the value in the results is calculated using the method \nbased on the normality assumption. We \nhave seen that in order to compute the power or the sample size, we have to make \na number of assumptions. These assumptions are used not only for the purpose of \ncalculation, but are also used in the actual t-test itself. So one important side \nbenefit of performing power analysis is to help us to better understand our designs \nand our hypotheses.<\/p>\n<p>We have seen in the power calculation process that what matters in the \ntwo-independent sample t-test is the difference in the means and \nthe standard deviations for the two groups. This leads to the concept of effect \nsize. In this case, the effect size will be the difference in means over the \npooled standard deviation. The larger the effect size, the larger the power \nfor a given sample size. Or, the larger the effect size, the smaller \nsample size needed to achieve the same power. So, a good estimate of effect \nsize is the key to a good power analysis. But it is not always an easy task to \ndetermine the effect size. Good estimates of effect size come from the existing literature \nor from pilot studies. <\/p>\n<h2>See Also<\/h2>\n<ul>\n<li>References<\/li>\n<ul>D. Moore and G. McCabe, Introduction to the Practice \n\t\tof Statistics, Third Edition, Section 6.4<\/ul>\n<\/ul>\n<p><?php include \"stat\/footer.htm\"; ?><\/p>\n<p>&nbsp; <!--webbot bot=\"PurpleText\" PREVIEW=\"Don't change anything below this line.\"\n--> \n<\/body>\n<\/html><\/p>\n","protected":false},"excerpt":{"rendered":"<p>Examples Example 1. A clinical dietician wants to compare two different diets, A and B, for diabetic patients. She hypothesizes that diet A (Group 1) will be better than diet&#8230;<br><a class=\"moretag\" href=\"https:\/\/stats.oarc.ucla.edu\/r\/dae\/power-analysis-for-two-group-independent-sample-t-test\/\"> Read More<\/a><\/p>\n","protected":false},"author":1,"featured_media":0,"parent":916,"menu_order":14,"comment_status":"closed","ping_status":"closed","template":"","meta":{"_genesis_hide_title":false,"_genesis_hide_breadcrumbs":false,"_genesis_hide_singular_image":false,"_genesis_hide_footer_widgets":false,"_genesis_custom_body_class":"","_genesis_custom_post_class":"","_genesis_layout":"","footnotes":""},"class_list":["post-932","page","type-page","status-publish","entry"],"_links":{"self":[{"href":"https:\/\/stats.oarc.ucla.edu\/wp-json\/wp\/v2\/pages\/932","targetHints":{"allow":["GET"]}}],"collection":[{"href":"https:\/\/stats.oarc.ucla.edu\/wp-json\/wp\/v2\/pages"}],"about":[{"href":"https:\/\/stats.oarc.ucla.edu\/wp-json\/wp\/v2\/types\/page"}],"author":[{"embeddable":true,"href":"https:\/\/stats.oarc.ucla.edu\/wp-json\/wp\/v2\/users\/1"}],"replies":[{"embeddable":true,"href":"https:\/\/stats.oarc.ucla.edu\/wp-json\/wp\/v2\/comments?post=932"}],"version-history":[{"count":2,"href":"https:\/\/stats.oarc.ucla.edu\/wp-json\/wp\/v2\/pages\/932\/revisions"}],"predecessor-version":[{"id":35794,"href":"https:\/\/stats.oarc.ucla.edu\/wp-json\/wp\/v2\/pages\/932\/revisions\/35794"}],"up":[{"embeddable":true,"href":"https:\/\/stats.oarc.ucla.edu\/wp-json\/wp\/v2\/pages\/916"}],"wp:attachment":[{"href":"https:\/\/stats.oarc.ucla.edu\/wp-json\/wp\/v2\/media?parent=932"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}