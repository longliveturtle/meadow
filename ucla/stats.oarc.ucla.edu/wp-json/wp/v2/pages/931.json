{"id":931,"date":"2016-02-11T18:29:03","date_gmt":"2016-02-11T18:29:03","guid":{"rendered":"http:\/\/dev2.hpc.ucla.edu\/r\/dae-3\/r-data-analysis-examplespower-analysis-for-one-sample-t-test\/"},"modified":"2017-01-05T12:51:54","modified_gmt":"2017-01-05T19:51:54","slug":"power-analysis-for-one-sample-t-test","status":"publish","type":"page","link":"https:\/\/stats.oarc.ucla.edu\/r\/dae\/power-analysis-for-one-sample-t-test\/","title":{"rendered":"&#13;\nPower Analysis for One-sample t-test |  R Data Analysis Examples"},"content":{"rendered":"<h2>Examples<\/h2>\n<p>Example 1. A company that manufactures light bulbs claims that a particular type of light \nbulb will last 850 hours on average with standard deviation of 50. A consumer \nprotection group thinks that the manufacturer has overestimated the lifespan of \ntheir light bulbs by about 40 \nhours. How many light bulbs does the consumer protection group have to test in \norder to prove their point with reasonable confidence? <\/p>\n<p>Example 2. It has been estimated that the average height of American white male adults\nis 70 inches. It has also been postulated that there is a\npositive correlation between height and intelligence.  If this is true, then the \naverage height of a white male graduate students on  campus \nshould be greater than the average height of American white male adults \nin general. You want to test this theory out by random sampling a small group of \nwhite male graduate students. But you need to know \nhow small the group can be or how few people that you need to measure \nsuch that you can still prove your point. <\/p>\n<h2>Prelude to The Power Analysis<\/h2>\n<p>For the power analysis below, we are going to focus on Example 1 testing the \naverage lifespan of a light bulb. Our first goal is to figure out the number of \nlight bulbs that need to be tested.&nbsp; That is, we will determine the sample \nsize for a given a significance level and power. Next, we will reverse the process \nand determine the power, given the sample size and the significance \nlevel. <\/p>\n<p>We know so far that the manufacturer claims that the average lifespan of the \nlight bulb is 850 with the standard deviation of 50, and the consumer protection \ngroup believes that the manufactory has overestimated by about 40 hours. So \nin terms of hypotheses, our null hypothesis is H<sub>0<\/sub> = 850 \nand our alternative hypothesis is H<sub>a<\/sub>= 810. <\/p>\n<p>The significance level is the probability of a Type I error, that is the \nprobability of rejecting H<sub>0<\/sub> when it is actually true. We will set it \nat the .05 level. The power of the test against H<sub>a<\/sub> is the probability of \nthat the test rejects H<sub>0<\/sub>. We will set it at .90 level.<\/p>\n<p>We are almost ready for our power analysis. But let&#8217;s talk about the standard \ndeviation a little bit. Intuitively, the number of light bulbs we need to test \ndepends on the variability of the lifespan of these light bulbs. Take an extreme \ncase where all the light bulbs have exactly the same lifespan. Then we just need \nto check a single light bulb to prove our point. Of course, this will never \nhappen. On the other hand, suppose that some light bulbs last for 1000 hours and some only \nlast 500 hours. We will have to select quite a few of light bulbs to cover all \nthe ground. Therefore, the standard deviation for the distribution of the \nlifespan of the light bulbs will play an important role in determining the \nsample size.<\/p>\n<h2>Power Analysis<\/h2>\n<p>In R, it is fairly straightforward to perform a power analysis for \ncomparing means. For example, we can use R&#8217;s <b>pwr.t.test<\/b> function for our \ncalculation as shown below. First, we specify the two means, the mean for the \nnull hypothesis and the mean for the alternative hypothesis divided by the \nstandard deviation for the population.  We also need to set the alpha level (.05 for\nour example), type equal to one.sample and alternative equal to two.sided (two-tail).<\/p>\n<ul>\n<pre><b>library(pwr)\r\n\r\npwr.t.test(d=(850-810)\/50,power=0.9,sig.level=0.05,type=\"one.sample\",alternative=\"two.sided\")<\/b>\r\n\r\n     One-sample t test power calculation \r\n\r\n              n = 18.44623\r\n              d = 0.8\r\n      sig.level = 0.05\r\n          power = 0.9\r\n    alternative = two.sided<\/pre>\n<\/ul>\n<p>The result tells us that we need a sample size at least 19 \nlight bulbs to reject H<sub>0<\/sub> under the alternative hypothesis H<sub>a<\/sub> to\nhave a power of 0.9. <\/p>\n<p>Next, suppose we have a sample of size 10, how much power do we have keeping all of the other\nnumbers the same? We can use the same program, <b>sampsi<\/b>, to calculate it.<\/p>\n<ul>\n<pre><b>pwr.t.test(d=(850-810)\/50,n=10,sig.level=0.05,type=\"one.sample\",alternative=\"two.sided\")<\/b>\r\n\r\n     One-sample t test power calculation \r\n\r\n              n = 10\r\n              d = 0.8\r\n      sig.level = 0.05\r\n          power = 0.6162328\r\n    alternative = two.sided<\/pre>\n<\/ul>\n<p>You can see that the power is about .616 for a sample size of 10. What then is the power for \nsample size of 15?<\/p>\n<ul>\n<pre><b>pwr.t.test(d=(850-810)\/50,n=15,sig.level=0.05,type=\"one.sample\",alternative=\"two.sided\")<\/b>\r\n\r\n     One-sample t test power calculation \r\n\r\n              n = 15\r\n              d = 0.8\r\n      sig.level = 0.05\r\n          power = 0.8213105\r\n    alternative = two.sided<\/pre>\n<\/ul>\n<p>So now the power is about .82. You could also do it again to find out the power for a \nsample size of 20. You&#8217;ll probably expect that the power will be greater. <\/p>\n<ul>\n<pre><b>pwr.t.test(d=(850-810)\/50,n=20,sig.level=0.05,type=\"one.sample\",alternative=\"two.sided\")<\/b>\r\n\r\n     One-sample t test power calculation \r\n\r\n              n = 20\r\n              d = 0.8\r\n      sig.level = 0.05\r\n          power = 0.9238988\r\n    alternative = two.sided<\/pre>\n<\/ul>\n<p>We can also expect that if we specified a lower power or the standard deviation \nis smaller, then the sample size should also be smaller. We can experiment with \ndifferent values of power and standard deviation as shown below. <\/p>\n<ul>\n<pre><b>pwr.t.test(d=(850-810)\/50,power=0.8,sig.level=0.05,type=\"one.sample\",alternative=\"two.sided\")<\/b>\r\n\r\n     One-sample t test power calculation \r\n\r\n              n = 14.30278\r\n              d = 0.8\r\n      sig.level = 0.05\r\n          power = 0.8\r\n    alternative = two.sided<\/pre>\n<\/ul>\n<p>If the standard deviation is lower, then the sample size should also go down, \nas we discussed before. <\/p>\n<ul>\n<pre><b>pwr.t.test(d=(850-810)\/30,power=0.8,sig.level=0.05,type=\"one.sample\",alternative=\"two.sided\")<\/b>\r\n\r\n     One-sample t test power calculation \r\n\r\n              n = 6.581121\r\n              d = 1.333333\r\n      sig.level = 0.05\r\n          power = 0.8\r\n    alternative = two.sided<\/pre>\n<\/ul>\n<h2>Discussion<\/h2>\n<p>There is another technical assumption, the normality assumption. If the \nvariable is not normally distributed, a small sample size usually will not have the \npower indicated in the results, because those results are calculated using the common method based on the normality assumption. It \nmight not even be a good idea to do a t-test on such a small sample to begin with \nif the normality assumption is in question.<\/p>\n<p>Here is another technical point. What we really need to know is the difference between the two means, not the \nindividual values. In fact, what really matters is the difference of the means \nover the standard deviation. We call this the effect size. For example, we would \nget the same power if we subtracted 800 from each mean, changing 850 to 50 and 810 to 10. <\/p>\n<ul>\n<pre><b>pwr.t.test(d=(50-10)\/50,power=0.9,sig.level=0.05,type=\"one.sample\",alternative=\"two.sided\")<\/b>\r\n\r\n     One-sample t test power calculation \r\n\r\n              n = 18.44623\r\n              d = 0.8\r\n      sig.level = 0.05\r\n          power = 0.9\r\n    alternative = two.sided<\/pre>\n<\/ul>\n<p>If we standardize our variable, we can calculate the means in terms of change \nin standard deviations.<\/p>\n<ul>\n<pre><b>pwr.t.test(d=(1-.2),power=0.9,sig.level=0.05,type=\"one.sample\",alternative=\"two.sided\")<\/b>\r\n\r\n     One-sample t test power calculation \r\n\r\n              n = 18.44623\r\n              d = 0.8\r\n      sig.level = 0.05\r\n          power = 0.9\r\n    alternative = two.sided<\/pre>\n<\/ul>\n<p>It is usually not an easy task to determine the &#8220;true&#8221; effect size. We make our best\nguess based upon the existing literature or a pilot study. A good estimate of the effect size \nis the key to a successful power analysis.<\/p>\n<h2>See Also<\/h2>\n<ul>\n<li>Related R Commands\n<ul>\n<li><b>pwr.t.test<\/b> &#8212;  Sample size and power determination.<\/li>\n<\/ul>\n<\/li>\n<li>References<\/li>\n<ul>D. Moore and G. McCabe, Introduction to the Practice \n\t\tof Statistics, Third Edition, Section 6.4.<\/ul>\n<\/ul>\n<p><?php include \"stat\/footer.htm\"; ?><\/p>\n<p>&nbsp; <!--webbot bot=\"PurpleText\" PREVIEW=\"Don't change anything below this line.\"\n--> \n<\/body>\n<\/html><\/p>\n","protected":false},"excerpt":{"rendered":"<p>Examples Example 1. A company that manufactures light bulbs claims that a particular type of light bulb will last 850 hours on average with standard deviation of 50. A consumer&#8230;<br><a class=\"moretag\" href=\"https:\/\/stats.oarc.ucla.edu\/r\/dae\/power-analysis-for-one-sample-t-test\/\"> Read More<\/a><\/p>\n","protected":false},"author":1,"featured_media":0,"parent":916,"menu_order":13,"comment_status":"closed","ping_status":"closed","template":"","meta":{"_genesis_hide_title":false,"_genesis_hide_breadcrumbs":false,"_genesis_hide_singular_image":false,"_genesis_hide_footer_widgets":false,"_genesis_custom_body_class":"","_genesis_custom_post_class":"","_genesis_layout":"","footnotes":""},"class_list":["post-931","page","type-page","status-publish","entry"],"_links":{"self":[{"href":"https:\/\/stats.oarc.ucla.edu\/wp-json\/wp\/v2\/pages\/931","targetHints":{"allow":["GET"]}}],"collection":[{"href":"https:\/\/stats.oarc.ucla.edu\/wp-json\/wp\/v2\/pages"}],"about":[{"href":"https:\/\/stats.oarc.ucla.edu\/wp-json\/wp\/v2\/types\/page"}],"author":[{"embeddable":true,"href":"https:\/\/stats.oarc.ucla.edu\/wp-json\/wp\/v2\/users\/1"}],"replies":[{"embeddable":true,"href":"https:\/\/stats.oarc.ucla.edu\/wp-json\/wp\/v2\/comments?post=931"}],"version-history":[{"count":2,"href":"https:\/\/stats.oarc.ucla.edu\/wp-json\/wp\/v2\/pages\/931\/revisions"}],"predecessor-version":[{"id":24083,"href":"https:\/\/stats.oarc.ucla.edu\/wp-json\/wp\/v2\/pages\/931\/revisions\/24083"}],"up":[{"embeddable":true,"href":"https:\/\/stats.oarc.ucla.edu\/wp-json\/wp\/v2\/pages\/916"}],"wp:attachment":[{"href":"https:\/\/stats.oarc.ucla.edu\/wp-json\/wp\/v2\/media?parent=931"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}