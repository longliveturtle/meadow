<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/strict.dtd"><html>
<!-- Mirrored from www.medicine.mcgill.ca/epidemiology/Joseph/courses/common/new-sampling.html by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 28 Feb 2025 09:39:00 GMT -->
<head>	<title>New Page</title></head><body><p><font color="#000000" size="5"><strong>new-sampling: specifying a new sampling distribution (illustrated with normal)</strong></font></p><p><font color="#0000FF">This example includes a demonstration of how future observations can also be modelled.</font></p><p><font color="#0000FF" size="3"><strong>Model:</strong></font></p><p>model {</p><p>&nbsp;&nbsp;&nbsp;<font color="#0000FF">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;trick using zeros</font></p><p>&nbsp;&nbsp;&nbsp;for (i in 1:7) {</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zeros[i] &lt;- 0</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zeros[i] ~ dpois(phi[i])&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000FF"># likelihood is exp(</font><font face="Symbol" color="#0000FF">-</font><font color="#0000FF">phi[i])</font></p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;phi[i] &lt;- log(sigma[1]) + 0.5 * pow((x[i] <font face="Symbol">-</font> mu[1]) / sigma[1], 2)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000FF"># </font><font face="Symbol" color="#0000FF">-</font><font color="#0000FF">log(likelihood)</font></p><p>&nbsp;&nbsp;&nbsp;}</p><p>&nbsp;&nbsp;&nbsp;<font color="#0000FF">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;check using normal distribution</font></p><p>&nbsp;&nbsp;&nbsp;for (i in 1:7) {</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x[i] ~ dnorm(mu[2], prec)</p><p>&nbsp;&nbsp;&nbsp;}</p><p>&nbsp;&nbsp;&nbsp;prec &lt;- 1 / (sigma[2] * sigma[2])</p><p>&nbsp;&nbsp;&nbsp;for (k in 1:2) {</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mu[k] ~ dunif(-10, 10)</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sigma[k] ~ dunif(0, 10)</p><p>&nbsp;&nbsp;&nbsp;}</p><p>}</p><p><font color="#0000FF" size="3"><strong>Data:</strong></font></p><p>list(x = c(-1, -0.3, 0.1, 0.2, 0.7, 1.2, 1.7))</p><p><font color="#0000FF" size="3"><strong>Initial values:</strong></font></p><p>list(sigma = c(1, 1), mu = c(0, 0))</p><p><font color="#0000FF">The results show a close match between the standard method and the zeros trick:</font></p><p>&nbsp;&nbsp;&nbsp;<font size="1"><strong>node&nbsp;&nbsp;&nbsp;mean&nbsp;&nbsp;&nbsp;sd&nbsp;&nbsp;&nbsp;MC error&nbsp;&nbsp;&nbsp;2.5%&nbsp;&nbsp;&nbsp;median&nbsp;&nbsp;&nbsp;97.5%&nbsp;&nbsp;&nbsp;start&nbsp;&nbsp;&nbsp;sample</strong></font></p><p>&nbsp;&nbsp;&nbsp;<font size="1">mu[1]&nbsp;&nbsp;&nbsp;0.3661&nbsp;&nbsp;&nbsp;0.4893&nbsp;&nbsp;&nbsp;0.00715&nbsp;&nbsp;&nbsp;-0.6296&nbsp;&nbsp;&nbsp;0.364&nbsp;&nbsp;&nbsp;1.336&nbsp;&nbsp;&nbsp;1001&nbsp;&nbsp;&nbsp;5000</font></p><p>&nbsp;&nbsp;&nbsp;<font size="1">mu[2]&nbsp;&nbsp;&nbsp;0.3668&nbsp;&nbsp;&nbsp;0.4734&nbsp;&nbsp;&nbsp;0.007003&nbsp;&nbsp;&nbsp;-0.5591&nbsp;&nbsp;&nbsp;0.3677&nbsp;&nbsp;&nbsp;1.291&nbsp;&nbsp;&nbsp;1001&nbsp;&nbsp;&nbsp;5000</font></p><p>&nbsp;&nbsp;&nbsp;<font size="1">sigma[1]&nbsp;&nbsp;&nbsp;1.191&nbsp;&nbsp;&nbsp;0.4902&nbsp;&nbsp;&nbsp;0.01456&nbsp;&nbsp;&nbsp;0.6293&nbsp;&nbsp;&nbsp;1.075&nbsp;&nbsp;&nbsp;2.476&nbsp;&nbsp;&nbsp;1001&nbsp;&nbsp;&nbsp;5000</font></p><p>&nbsp;&nbsp;&nbsp;<font size="1">sigma[2]&nbsp;&nbsp;&nbsp;1.168&nbsp;&nbsp;&nbsp;0.461&nbsp;&nbsp;&nbsp;0.009039&nbsp;&nbsp;&nbsp;0.6265&nbsp;&nbsp;&nbsp;1.062&nbsp;&nbsp;&nbsp;2.311&nbsp;&nbsp;&nbsp;1001&nbsp;&nbsp;&nbsp;5000</font></p><p><font color="#000000" size="5"><strong>Modelling future observations or missing data - add a missing data point to the data-file</strong></font></p><p><font color="#0000FF" size="3"><strong>Model:</strong></font></p><p>model {</p><p>&nbsp;&nbsp;&nbsp;<font color="#0000FF">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;trick using zeros</font></p><p>&nbsp;&nbsp;&nbsp;for (i in 1:8) {</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zeros[i] &lt;- 0</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zeros[i] ~ dpois(phi[i])&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000FF"># likelihood is exp(</font><font face="Symbol" color="#0000FF">-</font><font color="#0000FF">phi[i])</font></p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;phi[i] &lt;- log(sigma[1]) + 0.5 * pow((x[i] <font face="Symbol">-</font> mu[1]) / sigma[1], 2)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000FF"># </font><font face="Symbol" color="#0000FF">-</font><font color="#0000FF">log(likelihood)</font></p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000000">x[i] ~ dflat()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000FF"># improper uniform prior on x's</font></p><p>&nbsp;&nbsp;&nbsp;}</p><p>&nbsp;&nbsp;&nbsp;<font color="#0000FF">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;check using normal distribution</font></p><p>&nbsp;&nbsp;&nbsp;for (i in 1:8) {</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x.rep[i] ~ dnorm(mu[2], prec)</p><p>&nbsp;&nbsp;&nbsp;}</p><p>&nbsp;&nbsp;&nbsp;prec &lt;- 1 / (sigma[2] * sigma[2])</p><p>&nbsp;&nbsp;&nbsp;for (k in 1:2) {</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mu[k] ~ dunif(-10, 10)</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sigma[k] ~ dunif(0, 10)</p><p>&nbsp;&nbsp;&nbsp;}</p><p>}</p><p><font color="#0000FF" size="3"><strong>Data:</strong></font></p><p>list(x = c(-1, -0.3, 0.1, 0.2, 0.7, 1.2, 1.7, NA), x.rep=c(-1, -0.3, 0.1, 0.2, 0.7, 1.2, 1.7, NA))</p><p>(Note that in this case we need to replicate the dataset in order to compare results.)</p><p><font color="#0000FF" size="3"><strong>Initial values:</strong></font></p><p>list(sigma = c(1, 1), mu = c(0, 0), x = c(NA, NA, NA, NA, NA, NA, NA, 0))</p><p>(We need to give an initial value to the missing data, otherwise WinBUGS will try to generate one from the improper prior and crash!)</p><p><font color="#0000FF">The agreement is fine but the MC error on the prediction is large and so a long run is necessary:</font></p><p>&nbsp;&nbsp;&nbsp;<font size="1"><strong>node&nbsp;&nbsp;&nbsp;mean&nbsp;&nbsp;&nbsp;sd&nbsp;&nbsp;&nbsp;MC error&nbsp;&nbsp;&nbsp;2.5%&nbsp;&nbsp;&nbsp;median&nbsp;&nbsp;&nbsp;97.5%&nbsp;&nbsp;&nbsp;start&nbsp;&nbsp;&nbsp;sample</strong></font></p><p>&nbsp;&nbsp;&nbsp;<font size="1">mu[1]&nbsp;&nbsp;&nbsp;0.3689&nbsp;&nbsp;&nbsp;0.4948&nbsp;&nbsp;&nbsp;0.003145&nbsp;&nbsp;&nbsp;-0.6157&nbsp;&nbsp;&nbsp;0.3714&nbsp;&nbsp;&nbsp;1.351&nbsp;&nbsp;&nbsp;5001&nbsp;&nbsp;&nbsp;50000</font></p><p>&nbsp;&nbsp;&nbsp;<font size="1">mu[2]&nbsp;&nbsp;&nbsp;0.368&nbsp;&nbsp;&nbsp;0.486&nbsp;&nbsp;&nbsp;0.002319&nbsp;&nbsp;&nbsp;-0.6091&nbsp;&nbsp;&nbsp;0.3713&nbsp;&nbsp;&nbsp;1.326&nbsp;&nbsp;&nbsp;5001&nbsp;&nbsp;&nbsp;50000</font></p><p>&nbsp;&nbsp;&nbsp;<font size="1">sigma[1]&nbsp;&nbsp;&nbsp;1.194&nbsp;&nbsp;&nbsp;0.5066&nbsp;&nbsp;&nbsp;0.005429&nbsp;&nbsp;&nbsp;0.6222&nbsp;&nbsp;&nbsp;1.075&nbsp;&nbsp;&nbsp;2.46&nbsp;&nbsp;&nbsp;5001&nbsp;&nbsp;&nbsp;50000</font></p><p>&nbsp;&nbsp;&nbsp;<font size="1">sigma[2]&nbsp;&nbsp;&nbsp;1.187&nbsp;&nbsp;&nbsp;0.4989&nbsp;&nbsp;&nbsp;0.003917&nbsp;&nbsp;&nbsp;0.6224&nbsp;&nbsp;&nbsp;1.069&nbsp;&nbsp;&nbsp;2.45&nbsp;&nbsp;&nbsp;5001&nbsp;&nbsp;&nbsp;50000</font></p><p>&nbsp;&nbsp;&nbsp;<font size="1">x[8]&nbsp;&nbsp;&nbsp;0.357&nbsp;&nbsp;&nbsp;1.407&nbsp;&nbsp;&nbsp;0.01511&nbsp;&nbsp;&nbsp;-2.494&nbsp;&nbsp;&nbsp;0.3608&nbsp;&nbsp;&nbsp;3.133&nbsp;&nbsp;&nbsp;5001&nbsp;&nbsp;&nbsp;50000</font></p><p>&nbsp;&nbsp;&nbsp;<font size="1">x.rep[8]&nbsp;&nbsp;&nbsp;0.3585&nbsp;&nbsp;&nbsp;1.381&nbsp;&nbsp;&nbsp;0.006126&nbsp;&nbsp;&nbsp;-2.372&nbsp;&nbsp;&nbsp;0.3584&nbsp;&nbsp;&nbsp;3.105&nbsp;&nbsp;&nbsp;5001&nbsp;&nbsp;&nbsp;50000</font></p></body>
<!-- Mirrored from www.medicine.mcgill.ca/epidemiology/Joseph/courses/common/new-sampling.html by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 28 Feb 2025 09:39:00 GMT -->
</html>